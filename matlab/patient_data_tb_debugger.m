 %Engineer: Amey Kulkarni
 %Module Name:  patient_data_tb_debugger
 %Project Name: Spectral Doppler Ultrasound Imaging System

clear all
close all
clc
format compact

% Select a patient.
patient = 1;

% Load the data for that patient.
load patient_data_ADC
rx_signal = (rx_signals_I(patient,:) + 1i*rx_signals_Q(patient,:));

x_vals = 1:128;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Filter the signal.

% filter coefficients
coeffs_B = [0.0300594734259009,-0.0115375559857447,-0.00388938412414256,0.00350096286281524,0.00874053738870243,0.0107802349807998,0.00940566410661252,0.00513344721792368,-0.00108383273670873,-0.00806288747329538,-0.0146919559877883,-0.0200438439082470,-0.0235008737653277,-0.0247436389352284,-0.0238402721019534,-0.0210711490334906,-0.0169818906732913,-0.0122562264695017,-0.00764600931871177,-0.00389394429071837,-0.00161386596434338,-0.00121655727381419,-0.00281990679252409,-0.00621950493695609,-0.0109125113068831,-0.0161328439975859,-0.0209835985158980,-0.0245794198846927,-0.0262023376129241,-0.0254367265305507,-0.0222922374050886,-0.0171994096599491,-0.0110217141391948,-0.00487579577070650,-2.02452672593564e-05,0.00243879154293804,0.00170766848704199,-0.00250090474202130,-0.00986891798483064,-0.0194499649339163,-0.0297723241337513,-0.0389975866631518,-0.0451846002005578,-0.0466181111842410,-0.0420219945579665,-0.0309076525748373,-0.0134832370738942,0.00900097514703907,0.0346354982822630,0.0609736080074280,0.0851936584387758,0.104739107696998,0.117440923701292,0.121861309898371,0.117440923701292,0.104739107696998,0.0851936584387758,0.0609736080074280,0.0346354982822630,0.00900097514703907,-0.0134832370738942,-0.0309076525748373,-0.0420219945579665,-0.0466181111842410,-0.0451846002005578,-0.0389975866631518,-0.0297723241337513,-0.0194499649339163,-0.00986891798483064,-0.00250090474202130,0.00170766848704199,0.00243879154293804,-2.02452672593564e-05,-0.00487579577070650,-0.0110217141391948,-0.0171994096599491,-0.0222922374050886,-0.0254367265305507,-0.0262023376129241,-0.0245794198846927,-0.0209835985158980,-0.0161328439975859,-0.0109125113068831,-0.00621950493695609,-0.00281990679252409,-0.00121655727381419,-0.00161386596434338,-0.00389394429071837,-0.00764600931871177,-0.0122562264695017,-0.0169818906732913,-0.0210711490334906,-0.0238402721019534,-0.0247436389352284,-0.0235008737653277,-0.0200438439082470,-0.0146919559877883,-0.00806288747329538,-0.00108383273670873,0.00513344721792368,0.00940566410661252,0.0107802349807998,0.00874053738870243,0.00350096286281524,-0.00388938412414256,-0.0115375559857447,0.0300594734259009;];
coeffs_A = 1;

filtered_signal = filter(coeffs_B, coeffs_A, rx_signal(1:896*10));

hw_filtered = [395548 + -84707*1i; 871379 + -33990*1i; 1078023 + -89234*1i; 1585934 + -63441*1i; 1984825 + 38243*1i; 2206636 + -84752*1i; 2481093 + -77786*1i; 2524788 + -100106*1i; 2659831 + -183232*1i; 2651724 + -299354*1i; 2574682 + -308153*1i; 2343776 + -353066*1i; 1966800 + -332912*1i; 1788753 + -302199*1i; 1437783 + -433317*1i; 1013480 + -323073*1i; 568836 + -83016*1i; 186969 + 3202*1i; -321113 + 181516*1i; -828848 + 457113*1i; -1405829 + 503783*1i; -2043337 + 627467*1i; -2659480 + 798518*1i; -3286769 + 779312*1i; -3790943 + 794224*1i; -4287108 + 580408*1i; -4722251 + 450179*1i; -4998534 + 177670*1i; -5131974 + -64103*1i; -5054144 + -435327*1i; -4750665 + -679369*1i; -4314529 + -927924*1i; -3694508 + -1104609*1i; -2745733 + -1248620*1i; -1791538 + -1106860*1i; -555915 + -1059539*1i; 655328 + -895531*1i; 1987966 + -620656*1i; 3212684 + -421394*1i; 4507843 + -117927*1i; 5699557 + 295168*1i; 6829245 + 503251*1i; 7878548 + 701279*1i; 8797631 + 759576*1i; 9475844 + 946144*1i; 9909714 + 848378*1i; 10254304 + 941206*1i; 10102234 + 824650*1i; 9729352 + 702665*1i; 9023864 + 600672*1i; 7986698 + 427677*1i; 6341063 + 228084*1i; 4418109 + 126979*1i; 2168793 + 68777*1i; -439901 + -126908*1i; -3233721 + -125380*1i; -6196799 + -242973*1i; -9316671 + -300965*1i; -12339792 + -400758*1i; -15199902 + -378571*1i; -17859790 + -292315*1i; -20136668 + -203721*1i; -21702119 + -162591*1i; -22959279 + -34100*1i; -23483074 + -4970*1i; -23288230 + 51555*1i; -22308788 + 141746*1i; -20362615 + 319571*1i; -17904553 + 124637*1i; -14437789 + 160786*1i; -10430676 + 150554*1i; -5597673 + 23960*1i; -355841 + 75977*1i; 5419716 + -133622*1i; 11385624 + -229343*1i; 17605160 + -295185*1i; 23615071 + -313590*1i; 29340183 + -301696*1i; 34524361 + -296212*1i; 38970784 + -270469*1i; 42452079 + -230538*1i; 44658467 + -206936*1i; 45615958 + -2282*1i; 45113357 + -47609*1i; 43148124 + -121355*1i; 39596715 + -31208*1i; 34622895 + -143180*1i; 28128522 + -150401*1i; 20366136 + -220264*1i; 11798487 + -318174*1i; 2150387 + -480805*1i; -8029153 + -433326*1i; -18353499 + -472597*1i; -28707525 + -460394*1i; -38529062 + -320165*1i; -47615948 + -234455*1i; -55540600 + -119903*1i; -62110826 + 16490*1i; -66872277 + 203030*1i; -69731278 + 304300*1i; -70538476 + 485503*1i; -69123393 + 590367*1i; -65347130 + 460776*1i; -59619886 + 490463*1i; -51739869 + 485066*1i; -41966519 + 306380*1i; -30803327 + 169773*1i; -18473570 + 7557*1i; -5484015 + -114127*1i; 7943678 + -200298*1i; 21032577 + -170853*1i; 33564433 + -212089*1i; 45279675 + -97858*1i; 55377151 + 33132*1i; 64044951 + 303224*1i; 70697693 + 406948*1i; 75362741 + 583436*1i; 77751371 + 683761*1i; 78004072 + 894396*1i; 76052682 + 1142447*1i; 71973826 + 978113*1i; 66044775 + 931755*1i; 58299814 + 918684*1i; 49248622 + 814609*1i; 39058403 + 686444*1i; 27937968 + 557657*1i; 16444816 + 368155*1i; 4624378 + 209091*1i; -6906141 + 179665*1i; -18088746 + -8223*1i; -28348639 + 20145*1i; -37577419 + -71495*1i; -45429816 + -87802*1i; -52007600 + -80178*1i; -56911036 + -211862*1i; -60082610 + -268702*1i; -61529217 + -357056*1i; -61294476 + -517110*1i; -59694650 + -582262*1i; -56519230 + -780314*1i; -52093306 + -835936*1i; -46540973 + -899973*1i; -40281507 + -993677*1i; -33184235 + -892184*1i; -25867568 + -916834*1i; -18241540 + -792416*1i; -10688083 + -576745*1i; -3324751 + -508884*1i; 3732431 + -412687*1i; 10288507 + -258557*1i; 16259625 + -181916*1i; 21328712 + -87755*1i; 25886074 + -193621*1i; 29492306 + -190829*1i; 32060892 + -127299*1i; 33825420 + -60727*1i; 34854508 + -223028*1i; 34866792 + -310913*1i; 34145216 + -267736*1i; 32529572 + -190257*1i; 30291863 + -195996*1i; 27425310 + -65848*1i; 24115719 + -36025*1i; 20467134 + 93798*1i; 16542284 + 222158*1i; 12461811 + 257828*1i; 8512385 + 367655*1i; 4456277 + 347891*1i; 769572 + 426676*1i; -2772317 + 398760*1i; -5844049 + 423391*1i; -8676381 + 291961*1i; -11051595 + 228909*1i; -12894434 + 234734*1i; -14443504 + 92018*1i; -15447253 + 240953*1i; -16172545 + 271889*1i; -16326588 + 350098*1i; -16248362 + 512209*1i; -15735592 + 484562*1i; -14859854 + 552142*1i; -13810478 + 553263*1i; -12367336 + 541403*1i; -10901739 + 652450*1i; -9074373 + 568873*1i; -7229443 + 447782*1i; -5211964 + 332498*1i; -3275319 + 267205*1i; -1325767 + 142958*1i; 444859 + 46499*1i; 2177645 + -77230*1i; 3716267 + -208537*1i; 4982479 + -232755*1i; 6142945 + -357005*1i; 6901533 + -295450*1i; 7483080 + -200190*1i; 7804462 + -402322*1i; 8040451 + -357041*1i; 7981525 + -322967*1i; 7769457 + -342668*1i; 7344080 + -297865*1i; 6960140 + -332865*1i; 6264928 + -274604*1i; 5439061 + -253020*1i; 4738409 + -159456*1i; 3955265 + -113021*1i; 3063041 + -136957*1i; 2157023 + -2264*1i; 1278774 + -76685*1i; 454137 + -28878*1i; -414159 + 20799*1i; -1224600 + 29742*1i; -1884553 + -46190*1i; -2549820 + 51623*1i; -3147976 + -13244*1i; -3406187 + -8027*1i; -3708968 + 39168*1i; -3938433 + 35155*1i; -3823089 + -82070*1i; -3889117 + -65656*1i; -3644063 + 101241*1i; -3384756 + 19415*1i; -3250554 + 149395*1i; -2974232 + 102522*1i; -2689576 + 174120*1i; -2407352 + 289217*1i; -2149327 + 311735*1i; -1792211 + 347274*1i; -1563805 + 349011*1i; -1171628 + 332025*1i; -814994 + 349250*1i; -482290 + 300460*1i; 33143 + 279622*1i; 395168 + 261412*1i; 822343 + 126763*1i; 1072030 + 102484*1i; 1432717 + 54683*1i; 1681814 + 1117*1i; 1908579 + -77492*1i; 2078928 + 48524*1i; 2110715 + -20157*1i; 1925057 + -24917*1i; 1877728 + 125093*1i; 1798866 + 17115*1i; 1641536 + 62868*1i; 1538860 + 130497*1i; 1415523 + 29415*1i; 1325177 + 42435*1i; 1077299 + -118284*1i; 1023317 + -152971*1i; 868407 + -216358*1i; 768017 + -277128*1i; 584402 + -300994*1i; 388845 + -393783*1i; 96541 + -344617*1i; -114621 + -401043*1i; -190958 + -335959*1i; -481885 + -140563*1i; -620265 + -106323*1i; -755293 + -69754*1i; -859104 + 170523*1i; -806630 + 339305*1i; -815657 + 317333*1i; -833857 + 299856*1i; -671415 + 366560*1i; -545472 + 331886*1i; -464701 + 267814*1i; -348966 + 205132*1i; -432358 + 123222*1i; -399068 + 18213*1i; -408643 + -40758*1i; -614944 + -97691*1i; -658026 + -147600*1i; -754518 + -240542*1i; -885480 + -266944*1i; -944223 + -318275*1i; -938110 + -223636*1i; -867467 + -226397*1i; -610442 + -139207*1i; -494763 + -75469*1i; -142576 + -85438*1i; 126269 + -46954*1i; 340764 + -29008*1i; 567946 + 71823*1i; 761418 + 162945*1i; 830543 + 160172*1i; 983050 + 154337*1i; 966098 + 223273*1i; 993836 + 308861*1i; 919587 + 306317*1i; 803409 + 346229*1i; 731812 + 234345*1i; 800237 + 143318*1i; 818736 + 220658*1i; 856411 + 90321*1i; 794559 + 108892*1i; 870861 + 29557*1i; 896721 + 85885*1i; 783722 + 98889*1i; 844756 + -43006*1i; 782238 + -5124*1i; 514574 + 103325*1i; 266413 + 103419*1i; 134418 + 93422*1i; -218129 + 171595*1i; -490589 + 276351*1i; -791505 + 99828*1i; -998665 + 139791*1i; -1062748 + 103524*1i; -1183218 + -7265*1i; -1332488 + -18526*1i; -1301903 + -126035*1i; -1282295 + -270243*1i; -1230159 + -287091*1i; -1257967 + -390993*1i; -1167315 + -276412*1i; -1188897 + -172181*1i; -1086598 + -10928*1i; -1018670 + -834*1i; -956048 + 183420*1i; -1045540 + 346287*1i; -877162 + 264508*1i; -716147 + 420064*1i; -639510 + 297667*1i; -384887 + 115122*1i; -349482 + -88196*1i; -64226 + -271853*1i; 293404 + -509536*1i; 436766 + -766706*1i; 733262 + -888056*1i; 1042845 + -962730*1i; 1168742 + -853121*1i; 1366315 + -729195*1i; 1426371 + -506712*1i; 1446358 + -268191*1i; 1496360 + 2681*1i; 1441769 + 177502*1i; 1362071 + 426828*1i; 1342563 + 603112*1i; 1221378 + 624976*1i; 1130431 + 523138*1i; 979588 + 494942*1i; 869655 + 324579*1i; 618352 + 183111*1i; 362860 + -105090*1i; 233192 + -133225*1i; 203490 + -305342*1i; -91851 + -396270*1i; -190465 + -279395*1i; -346009 + -219192*1i; -550290 + -41380*1i; -668398 + 301438*1i; -849302 + 458235*1i; -968270 + 719273*1i; -999321 + 762097*1i; -1118509 + 813784*1i; -1194725 + 831573*1i; -1158273 + 761561*1i; -1085590 + 587778*1i; -1047647 + 385166*1i; -1108767 + 272120*1i; -1044622 + -48930*1i; -873154 + -155330*1i; -687210 + -352059*1i; -465497 + -374047*1i; -481138 + -409268*1i; -303199 + -442763*1i; -3485 + -297788*1i; 155564 + -195720*1i; 304255 + -223846*1i; 429142 + -56472*1i; 662588 + 2426*1i; 753934 + 29641*1i; 954673 + 85751*1i; 886878 + 84699*1i; 994783 + 6147*1i; 1155578 + -43425*1i; 948651 + -10095*1i; 1051459 + -73004*1i; 1131658 + -41122*1i; 1142663 + -154045*1i; 1219882 + -50686*1i; 1142071 + -11884*1i; 1017551 + -60662*1i; 1073989 + -79716*1i; 940901 + -189906*1i; 879391 + -240796*1i; 755176 + -228441*1i; 585416 + -293399*1i; 343395 + -363755*1i; 57852 + -364419*1i; -227963 + -319690*1i; -603001 + -442124*1i; -822736 + -500001*1i; -1158471 + -331493*1i; -1298682 + -171947*1i; -1566607 + -74270*1i; -1833861 + 97814*1i; -1834734 + 221839*1i; -1898091 + 435049*1i; -1811325 + 478035*1i; -1792183 + 643460*1i; -1529077 + 608842*1i; -1349772 + 707959*1i; -1169975 + 643160*1i; -882302 + 464151*1i; -646639 + 474760*1i; -456629 + 349825*1i; -278358 + 163324*1i; 22003 + -1477*1i; 189836 + -113954*1i; 363466 + -228263*1i; 393564 + -330332*1i; 436852 + -411240*1i; 505449 + -462679*1i; 583339 + -479445*1i; 707073 + -410106*1i; 626551 + -249576*1i; 769146 + -198531*1i; 906337 + -97741*1i; 1021904 + -29556*1i; 1140002 + 90552*1i; 1156890 + 197859*1i; 1309746 + 365650*1i; 1340749 + 299997*1i; 1421221 + 164838*1i; 1369732 + 268577*1i; 1339429 + 79386*1i; 1278080 + -32312*1i; 1116817 + -110632*1i; 927864 + -70819*1i; 617471 + -192281*1i; 265616 + -231221*1i; -15139 + 27559*1i; -306920 + -24683*1i; -735686 + 192395*1i; -863502 + 289253*1i; -1238497 + 460908*1i; -1329460 + 473262*1i; -1438525 + 497919*1i; -1529647 + 371387*1i; -1563916 + 325257*1i; -1447838 + 110958*1i; -1375368 + -139873*1i; -1334193 + -347302*1i; -1203050 + -599938*1i; -1179478 + -810490*1i; -1118469 + -903545*1i; -1036625 + -977733*1i; -1005896 + -906573*1i; -983399 + -916513*1i; -948956 + -553058*1i; -893740 + -438235*1i; -752999 + -159387*1i; -682931 + -19755*1i; -422691 + 112253*1i; -172230 + 173221*1i; 99284 + 205290*1i; 220466 + 155448*1i; 516748 + 85172*1i; 758025 + -7463*1i; 1038047 + -172012*1i; 1162527 + -318971*1i; 1272568 + -375746*1i; 1418086 + -281790*1i; 1439844 + -205162*1i; 1467513 + -133778*1i; 1385767 + 70213*1i; 1460951 + 354352*1i; 1471105 + 545063*1i; 1583717 + 706637*1i; 1628818 + 906013*1i; 1671660 + 814625*1i; 1864109 + 823426*1i; 1940714 + 750875*1i; 2066854 + 461321*1i; 2077312 + 321997*1i; 2040383 + 60913*1i; 1943821 + -234226*1i; 1818373 + -320413*1i; 1526509 + -280744*1i; 1324129 + -358951*1i; 1030395 + -282638*1i; 531567 + 964*1i; 118222 + 115979*1i; -502276 + 417051*1i; -1000199 + 504161*1i; -1512806 + 750430*1i; -1918502 + 787106*1i; -2412471 + 774109*1i; -2912920 + 808052*1i; -3328101 + 548585*1i; -3842991 + 345116*1i; -4123044 + 150905*1i; -4455802 + -119545*1i; -4610930 + -371300*1i; -4817546 + -538498*1i; -4823590 + -543125*1i; -4739251 + -622989*1i; -4483402 + -648233*1i; -4147922 + -559417*1i; -3660016 + -405563*1i; -2999442 + -336780*1i; -2415569 + -180318*1i; -1355873 + -135554*1i; -554613 + -67465*1i; 386277 + -144713*1i; 1417255 + -107751*1i; 2527851 + -146932*1i; 3594237 + -194516*1i; 4592356 + -228783*1i; 5622583 + -415085*1i; 6493649 + -422020*1i; 7410910 + -349690*1i; 8017993 + -332314*1i; 8738794 + -254884*1i; 9071762 + -142779*1i; 9455487 + -103131*1i; 9355624 + 54995*1i; 9342701 + 102331*1i; 8891108 + 210220*1i; 8099310 + 303860*1i; 7186494 + 202301*1i; 5804215 + 296701*1i; 4213829 + 208970*1i; 2422731 + 158439*1i; 448869 + 2019*1i; -1568677 + -56384*1i; -3725023 + -236844*1i; -6018354 + -219665*1i; -8206970 + -246599*1i; -10381471 + -272329*1i; -12394047 + -129523*1i; -14248455 + -86441*1i; -16008538 + -1933*1i; -17375528 + 142884*1i; -18435082 + 343326*1i; -19201153 + 334895*1i; -19552824 + 411990*1i; -19658475 + 482073*1i; -19043043 + 354184*1i; -18087134 + 238837*1i; -16487863 + 202575*1i; -14415630 + 115309*1i; -11757434 + -15389*1i; -8487860 + -194590*1i; -4935151 + -351218*1i; -955287 + -399946*1i; 3378050 + -467633*1i; 7930221 + -508635*1i; 12600131 + -371045*1i; 17387466 + -319994*1i; 22103979 + -110586*1i; 26423501 + -42983*1i; 30507294 + 77785*1i; 34154530 + 240184*1i; 37210774 + 328586*1i; 39588008 + 425944*1i; 41086690 + 508742*1i; 41837331 + 573220*1i; 41571468 + 527463*1i; 40261518 + 503758*1i; 37965033 + 408735*1i; 34611073 + 373542*1i; 30112187 + 195221*1i; 24671329 + 59575*1i; 18038193 + -3448*1i; 10781316 + -88832*1i; 2688895 + -254877*1i; -5925234 + -388726*1i; -14853346 + -363049*1i; -23822272 + -299036*1i; -32616855 + -389129*1i; -41129812 + -314934*1i; -48849130 + -263651*1i; -55751873 + -137595*1i; -61425953 + -117351*1i; -65849452 + 74195*1i; -68774561 + 182777*1i; -69955005 + 253559*1i; -69507086 + 336854*1i; -67063215 + 404996*1i; -62859111 + 426127*1i; -56814326 + 472113*1i; -49124275 + 349745*1i; -39962211 + 334020*1i; -29328891 + 329686*1i; -17488671 + 107603*1i; -4949579 + -40820*1i; 8262589 + -19149*1i; 21526737 + -224570*1i; 34548655 + -242290*1i; 46752480 + -360697*1i; 57714707 + -115653*1i; 67296108 + -278799*1i; 74669823 + -267198*1i; 79818744 + -251679*1i; 82363340 + -201183*1i; 82020485 + -132186*1i; 79131076 + -111277*1i; 73467179 + -135609*1i; 65137296 + -228522*1i; 54553242 + -286616*1i; 42098885 + -272337*1i; 28240038 + -262518*1i; 13627807 + -317497*1i; -1351164 + -233941*1i; -15881498 + -298659*1i; -29447568 + -255966*1i; -41654238 + -25554*1i; -51559404 + 51701*1i; -59324684 + 167900*1i; -64420111 + 224374*1i; -66699769 + 267004*1i; -66057037 + 233282*1i; -62799542 + 162876*1i; -57066894 + 85315*1i; -49122339 + -2384*1i; -39410515 + -191885*1i; -28381219 + -384686*1i; -16743992 + -391966*1i; -4612623 + -426073*1i; 6941977 + -442891*1i; 17842539 + -288346*1i; 27289563 + -143480*1i; 35235440 + 10049*1i; 41323328 + 224720*1i; 45099804 + 338235*1i; 46804648 + 418535*1i; 46318597 + 416597*1i; 43842728 + 381976*1i; 39519340 + 399709*1i; 33537269 + 241143*1i; 26581990 + 218783*1i; 18817720 + 67015*1i; 10435166 + -121051*1i; 2209726 + -166119*1i; -5798141 + -50395*1i; -13007861 + -6541*1i; -19360996 + -9543*1i; -24686667 + 228272*1i; -28607892 + 327878*1i; -31030929 + 474970*1i; -32300217 + 545939*1i; -31968185 + 612992*1i; -30444520 + 647689*1i; -27843921 + 455705*1i; -24146093 + 162839*1i; -19837941 + 63112*1i; -14852535 + -165176*1i; -9633983 + -359778*1i; -4167214 + -540764*1i; 1107983 + -665087*1i; 6149969 + -579228*1i; 10581055 + -557455*1i; 14407019 + -494140*1i; 17396459 + -197610*1i; 19501145 + -133111*1i; 20768703 + 238932*1i; 20969685 + 418768*1i; 20248180 + 565647*1i; 18742381 + 567005*1i; 16460370 + 613807*1i; 13529861 + 380326*1i; 10233356 + 352050*1i; 6696897 + 71910*1i; 3078383 + -139012*1i; -520670 + -382441*1i; -3868608 + -600587*1i; -6762094 + -632726*1i; -9228215 + -635010*1i; -10943053 + -679054*1i; -12298286 + -556721*1i; -12960703 + -281971*1i; -13079322 + -37905*1i; -12622713 + 178842*1i; -11767472 + 396565*1i; -10579807 + 417871*1i; -9139645 + 514084*1i; -7366754 + 565636*1i; -5557162 + 546996*1i; -3651431 + 457504*1i; -1540293 + 279834*1i; 274242 + 140514*1i; 2076894 + 12930*1i; 3764708 + -95215*1i; 5167010 + -239946*1i; 6422533 + -228793*1i; 7347475 + -279815*1i; 8078145 + -260363*1i; 8373384 + -284063*1i; 8354908 + -278706*1i; 8012986 + -109649*1i; 7222664 + -166830*1i; 6287057 + -228249*1i; 5122458 + -213903*1i; 3596194 + -388752*1i; 2224161 + -309192*1i; 657532 + -401641*1i; -872762 + -255459*1i; -2051076 + -314043*1i; -3193730 + -255350*1i; -3957916 + -318595*1i; -4541616 + -235440*1i; -4982113 + -86356*1i; -5008509 + -42825*1i; -4763108 + 14658*1i; -4372359 + 39847*1i; -3823662 + 69197*1i; -3254805 + -34329*1i; -2623451 + 63395*1i; -1880400 + -28829*1i; -1372880 + 79583*1i; -774157 + -86861*1i; -251270 + -202645*1i; 219820 + -150138*1i; 703181 + -249198*1i; 1022709 + -222838*1i; 1258760 + -250617*1i; 1537938 + -271802*1i; 1822683 + -218585*1i; 1890700 + -227535*1i; 2023969 + -67918*1i; 1933418 + 65656*1i; 1942832 + 205469*1i; 1852617 + 228590*1i; 1603415 + 393095*1i; 1349726 + 605474*1i; 1000474 + 648603*1i; 690849 + 664390*1i; 128455 + 747830*1i; -262181 + 851434*1i; -535474 + 918207*1i; -889514 + 826773*1i; -1090026 + 777511*1i; -1138312 + 544973*1i; -1129456 + 423372*1i; -972761 + 218240*1i; -855738 + 94151*1i; -581355 + 39826*1i; -299622 + -94923*1i; -27426 + -190846*1i; 286678 + -335059*1i; 541806 + -206752*1i; 745926 + -296476*1i; 823815 + -312085*1i; 848018 + -277558*1i; 786683 + -258595*1i; 855547 + -223703*1i; 644462 + -169707*1i; 531224 + -184169*1i; 521948 + -25790*1i; 251227 + -58905*1i; 217347 + -48014*1i; 85414 + 23981*1i; 106708 + 105434*1i; -46974 + 101338*1i; -108584 + 51817*1i; -232219 + -95906*1i; -307736 + -51494*1i; -441879 + -56346*1i; -578511 + -139334*1i; -621472 + -73949*1i; -722757 + -123465*1i; -822960 + -243145*1i; -846039 + -306266*1i; -908125 + -182273*1i; -829646 + -194559*1i; -714231 + -210675*1i; -558897 + -145429*1i; -443095 + -18452*1i; -151459 + 58705*1i; 59821 + 177771*1i; 308317 + 321954*1i; 459531 + 400574*1i; 675734 + 323143*1i; 669452 + 524443*1i; 780304 + 444141*1i; 696494 + 247554*1i; 625158 + 214994*1i; 464795 + 45986*1i; 286147 + -56841*1i; 94810 + -66386*1i; -100836 + -320162*1i; -371127 + -424065*1i; -515360 + -484964*1i; -686784 + -411165*1i; -856174 + -390835*1i; -839855 + -252771*1i; -826313 + -52056*1i; -811520 + 8656*1i; -741513 + 207695*1i; -694393 + 248136*1i; -505141 + 429899*1i; -477202 + 481890*1i; -318483 + 445139*1i; -181095 + 524247*1i; 66650 + 395383*1i; 430277 + 392501*1i; 623683 + 352964*1i; 963428 + 300477*1i; 1226945 + 231220*1i; 1527089 + -11704*1i; 1747717 + 42402*1i; 1999883 + -12933*1i; 1921240 + -133275*1i; 1911978 + -238575*1i; 1871542 + -288386*1i; 1730680 + -438898*1i; 1484405 + -701929*1i; 1158581 + -586867*1i; 793639 + -716030*1i; 227441 + -687124*1i; -135697 + -754606*1i; -584354 + -658593*1i; -1029006 + -652091*1i; -1280510 + -506930*1i; -1465382 + -330403*1i; -1759662 + -157514*1i; -1930424 + 48486*1i; -1899872 + 154875*1i; -1832923 + 332265*1i; -1704915 + 358892*1i; -1488348 + 463098*1i; -1455432 + 484634*1i; -1116585 + 470453*1i; -881061 + 355238*1i; -592836 + 186689*1i; -231435 + 203866*1i; 97503 + 109649*1i; 326545 + 25706*1i; 576298 + 67283*1i; 891402 + -52448*1i; 1040235 + 75059*1i; 1179767 + 121612*1i; 1569347 + 65010*1i; 1527712 + 77560*1i; 1719560 + 83147*1i; 1642884 + 26225*1i; 1642696 + 104517*1i; 1412864 + 153530*1i; 1318398 + 107969*1i; 1054695 + 209664*1i; 787574 + 139968*1i; 519700 + 160212*1i; 234686 + 337646*1i; -94645 + 328642*1i; -354213 + 433359*1i; -710384 + 451164*1i; -880632 + 480374*1i; -1161605 + 403876*1i; -1247386 + 408976*1i; -1416019 + 304979*1i; -1444405 + 141678*1i; -1472143 + 118006*1i; -1411000 + -12514*1i; -1295976 + -112734*1i; -1171242 + -287002*1i; -1099512 + -383397*1i; -867002 + -340907*1i; -683569 + -422599*1i; -366992 + -283474*1i; -260747 + -170066*1i; 91273 + 15564*1i; 311009 + -8683*1i; 617252 + -35685*1i; 899221 + 27675*1i; 1144060 + -74201*1i; 1360995 + -48444*1i; 1569514 + 81024*1i; 1642582 + -132168*1i; 1781865 + -282154*1i; 1639287 + -301656*1i; 1578692 + -215974*1i; 1339720 + -421509*1i; 1132353 + -187126*1i; 762584 + -203270*1i; 461261 + 3976*1i; 57248 + 119612*1i; -217746 + 331300*1i; -626650 + 507757*1i; -828289 + 520214*1i; -1042149 + 699915*1i; -1236759 + 683181*1i; -1266370 + 511788*1i; -1410572 + 340946*1i; -1301362 + 197393*1i; -1183108 + -88391*1i; -1023441 + -296118*1i; -1022004 + -424020*1i; -750965 + -622547*1i; -518501 + -805116*1i; -342228 + -691296*1i; -147157 + -792324*1i; 13082 + -784047*1i; 272108 + -469785*1i];
%difff(transpose(filtered_signal(897:896*2)), hw_filtered / 2^14);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Downsample the filtered signal.

downsampled_signal = downsample(filtered_signal,7);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Apply a Hamming window.

filtered_signal_2D = reshape(downsampled_signal,128,[]);

windowed_signal = filtered_signal_2D .* ...
    repmat(hamming(128), 1, size(filtered_signal_2D,2));

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Compute the FFT.

matlab_fft_col1 = fft(windowed_signal(:,1), 128);
matlab_fft_col2 = fft(windowed_signal(:,2), 128);
matlab_fft_col3 = fft(windowed_signal(:,3), 128);
matlab_fft_col4 = fft(windowed_signal(:,4), 128);
matlab_fft_col5 = fft(windowed_signal(:,5), 128);
matlab_fft_col6 = fft(windowed_signal(:,6), 128);
matlab_fft_col7 = fft(windowed_signal(:,7), 128);
matlab_fft_col8 = fft(windowed_signal(:,8), 128);
matlab_fft_col9 = fft(windowed_signal(:,9), 128);
matlab_fft_col10 = fft(windowed_signal(:,10), 128);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Compare to simulation results.

% The following data was generated by simulating my Verilog design using
% the Xilinx ISim simulator.
hw_fft_col1 = [-4268 + 1594*1i; 3825 + -3844*1i; -6259 + 2443*1i; -4311 + -4213*1i; 1023 + -521*1i; -2050 + 9481*1i; 2193 + -4199*1i; 10760 + 16035*1i; 12785 + -34932*1i; 7781 + 16404*1i; -29985 + -68699*1i; -32664 + -989*1i; -14453 + -98336*1i; -63092 + 129340*1i; -215977 + -114343*1i; 278510 + 108578*1i; -464380 + 297596*1i; 381165 + -414648*1i; 91440 + 974330*1i; -506612 + -878614*1i; 1540277 + 492750*1i; -1690905 + 376561*1i; 1691674 + -2026336*1i; -199026 + 2705070*1i; -1851890 + -3476414*1i; 2655715 + 2154475*1i; -3855540 + -125665*1i; 2824116 + -827760*1i; -1232682 + 2173200*1i; 272038 + -1774427*1i; 946317 + 1291550*1i; -794853 + -609402*1i; 936904 + -230340*1i; -445153 + 224515*1i; 119005 + -579414*1i; -43108 + 212468*1i; -267657 + -231593*1i; 52874 + 86215*1i; -179551 + 14547*1i; -1778 + 27366*1i; 7325 + 73732*1i; -47917 + 64170*1i; 58208 + 38627*1i; 8501 + 11846*1i; 34966 + 45180*1i; 38783 + -22612*1i; 32510 + 18554*1i; 36349 + -16740*1i; 24101 + -28663*1i; 11592 + -66680*1i; -18166 + -25264*1i; 15402 + -19760*1i; -56573 + -39210*1i; -34124 + -16168*1i; -50382 + 3027*1i; -16176 + 27244*1i; -25832 + 12297*1i; 8841 + 44283*1i; -210 + 24976*1i; -10283 + 5309*1i; 28942 + 37130*1i; 18724 + -14451*1i; -2428 + -6235*1i; 12752 + 1229*1i; 2886 + -7806*1i; 1544 + 20256*1i; 8753 + -1941*1i; 12089 + -20942*1i; 7597 + 6001*1i; 40359 + -14847*1i; -15402 + -2619*1i; 1520 + -74596*1i; -37782 + -40228*1i; -15831 + 16371*1i; -27506 + -15519*1i; -70990 + 23648*1i; -22110 + 37505*1i; -15693 + 31172*1i; -3895 + 7786*1i; -5489 + 62470*1i; 63404 + 45538*1i; 23859 + -2201*1i; -6360 + -4066*1i; 75679 + 11008*1i; 25381 + -17872*1i; 23654 + -45820*1i; 39303 + -32096*1i; -9449 + -45167*1i; -27021 + -79593*1i; -42294 + -57256*1i; -138234 + -15553*1i; 35157 + -34616*1i; -266242 + 187325*1i; -27484 + -196606*1i; 122046 + 566936*1i; -457470 + -213814*1i; 997920 + 236056*1i; -851909 + 582965*1i; 961676 + -1268233*1i; 270654 + 1752272*1i; -1237079 + -2155517*1i; 2814586 + 832665*1i; -3833554 + 140211*1i; 2647543 + -2202264*1i; -1841540 + 3527306*1i; -204034 + -2740560*1i; 1673721 + 2017575*1i; -1664046 + -327523*1i; 1514779 + -500342*1i; -477952 + 834684*1i; 77448 + -940412*1i; 358581 + 423798*1i; -404195 + -287307*1i; 221299 + -133234*1i; -218238 + 121268*1i; -55033 + -148212*1i; 15633 + 99103*1i; -89191 + 8977*1i; 9801 + 47393*1i; 11905 + 11116*1i; 560 + 3490*1i; 12350 + 19183*1i; 11526 + -8860*1i; -1809 + -3686*1i; -9151 + -580*1i; -1366 + 877*1i; -3393 + -200*1i; 1415 + 3479*1i];
hw_fft_col2 = [-6518 + 3135*1i; 3921 + -8859*1i; 6842 + 5745*1i; -9301 + 4490*1i; 9333 + -8280*1i; -10741 + 12975*1i; -960 + -36106*1i; 30685 + 32052*1i; -59825 + 44515*1i; -10321 + -97651*1i; 201774 + 66108*1i; -209156 + 69252*1i; 992 + -348429*1i; 209211 + 322316*1i; -527372 + 145846*1i; 373435 + -377883*1i; 538153 + 650006*1i; -729272 + -419269*1i; 768516 + -1109582*1i; -448791 + 1249452*1i; -1936697 + -830158*1i; 2093396 + 772701*1i; -651564 + 2072862*1i; 358094 + -2494174*1i; 2445738 + 231271*1i; -2555564 + 562189*1i; -539618 + -2570528*1i; 1583774 + 1454788*1i; -1831583 + 1610857*1i; -237578 + -1581184*1i; 1908575 + 291938*1i; -523448 + 1152031*1i; -664490 + -1058034*1i; 817862 + -348760*1i; -146144 + 669176*1i; -556913 + -228161*1i; 305882 + -252065*1i; 131745 + 380353*1i; -263356 + -24716*1i; 131431 + -184577*1i; 95623 + 144657*1i; -125125 + -8926*1i; 32036 + -103072*1i; 51168 + 76330*1i; -67606 + 13369*1i; 20366 + -44015*1i; 44904 + 28930*1i; -67462 + 13653*1i; 45026 + -24659*1i; 12231 + -13596*1i; -5822 + 40630*1i; -19041 + -18720*1i; 11258 + -46968*1i; 1465 + 54382*1i; 18482 + -22180*1i; -38679 + 37928*1i; 19951 + -29197*1i; 25826 + -16683*1i; -30859 + 11621*1i; -2239 + 829*1i; 11703 + -5788*1i; -7122 + 17804*1i; -3125 + -10101*1i; -2520 + 10561*1i; 6095 + -5581*1i; -4030 + 1633*1i; 5737 + -14939*1i; -15332 + 22093*1i; 27493 + -5453*1i; -43636 + -3082*1i; 23893 + -8066*1i; 17209 + 41780*1i; -30760 + -31855*1i; 1345 + 7394*1i; 3589 + -37014*1i; 1616 + 56566*1i; -4438 + -45865*1i; 5800 + 50478*1i; -16426 + -29149*1i; 29011 + -14847*1i; -13372 + 25676*1i; -33142 + -2272*1i; 55365 + -61230*1i; -27008 + 85404*1i; -49067 + -37527*1i; 43096 + -57503*1i; 32810 + 122805*1i; -142132 + -39366*1i; 106318 + -107382*1i; 138286 + 143505*1i; -242620 + 70384*1i; 99641 + -354945*1i; 302780 + 219797*1i; -532350 + 248852*1i; -166617 + -670228*1i; 851847 + 357004*1i; -671652 + 1014432*1i; -551228 + -1118365*1i; 1928826 + -342934*1i; -236900 + 1617752*1i; -1820205 + -1628016*1i; 1584612 + -1439455*1i; -538554 + 2553185*1i; -2574461 + -561487*1i; 2455134 + -239083*1i; 337192 + 2491802*1i; -613297 + -2074674*1i; 2047399 + -763946*1i; -1893912 + 848127*1i; -467483 + -1277236*1i; 788565 + 1081413*1i; -734427 + 450501*1i; 497029 + -659417*1i; 400429 + 449348*1i; -508826 + -201866*1i; 204136 + -298566*1i; -841 + 303043*1i; -195835 + -45587*1i; 163648 + -66447*1i; 4359 + 89926*1i; -57671 + -43641*1i; 40898 + -26813*1i; -8702 + 31289*1i; -6402 + -11181*1i; 4204 + 3390*1i; -686 + -4654*1i; 3801 + -6164*1i; 903 + 9048*1i];
hw_fft_col3 = [-30273 + 2962*1i; 5713 + -3742*1i; 23628 + 10019*1i; 539 + -39*1i; -4239 + -11081*1i; 6693 + 17978*1i; -2556 + 6060*1i; 18357 + -23684*1i; 1127 + -24917*1i; -31567 + 868*1i; -29911 + 120686*1i; 80478 + -80499*1i; 132291 + -113842*1i; -141356 + 102746*1i; -355000 + 108518*1i; 327000 + -155826*1i; 659916 + 117884*1i; -604945 + 131784*1i; -989460 + -580756*1i; 1036005 + 56465*1i; 1256687 + 1377104*1i; -1509504 + -444124*1i; -1321489 + -2922268*1i; 2113954 + 2264923*1i; 376336 + 2656708*1i; -976394 + -2396817*1i; -22791 + -2085495*1i; -212742 + 1218716*1i; -610671 + 1716414*1i; 439437 + -86866*1i; 1113716 + -874202*1i; 22738 + -433327*1i; -869018 + 5688*1i; -417117 + 265887*1i; 373676 + 255853*1i; 320648 + 65271*1i; 44611 + -204992*1i; -175778 + -208532*1i; -128484 + 76188*1i; 46883 + 120555*1i; 28672 + 64994*1i; 74620 + -67731*1i; -31976 + -67961*1i; -38580 + 3234*1i; -4677 + 49919*1i; 8115 + 1865*1i; 32435 + -13783*1i; -4541 + -23356*1i; 4620 + 9858*1i; -40661 + 11250*1i; 18095 + -43919*1i; 19338 + 44367*1i; 20417 + -38305*1i; -41470 + -4541*1i; -14960 + 25941*1i; 37058 + -36004*1i; -21716 + 24889*1i; 13244 + -12259*1i; -9230 + 43955*1i; -1912 + -47918*1i; 11807 + 10423*1i; -8488 + 10383*1i; 8623 + -7302*1i; -18 + -1360*1i; -8773 + 3224*1i; 15750 + -2323*1i; -14460 + -1345*1i; 217 + 14350*1i; 10830 + -11082*1i; -2315 + -14357*1i; -15702 + -6152*1i; -5216 + 20209*1i; 23801 + 5288*1i; -21665 + 6787*1i; 26737 + -35161*1i; -17884 + 21531*1i; 1826 + 16875*1i; 4180 + -858*1i; 20344 + -29510*1i; -33909 + 29359*1i; 914 + -29647*1i; -2052 + 15667*1i; 22811 + 53686*1i; 5921 + -32509*1i; 5065 + -42244*1i; -39582 + -1542*1i; -26888 + 58286*1i; 37292 + 52269*1i; 59659 + -29532*1i; 25255 + -147763*1i; -93406 + -30984*1i; -195375 + 166913*1i; 18114 + 216902*1i; 379138 + -70062*1i; 318728 + -300073*1i; -387473 + -215469*1i; -894554 + -39022*1i; 57791 + 420649*1i; 1072647 + 909184*1i; 446296 + 86413*1i; -632135 + -1738504*1i; -209765 + -1197287*1i; -2260 + 2086988*1i; -974769 + 2387651*1i; 369860 + -2651536*1i; 2133663 + -2300314*1i; -1356788 + 2917176*1i; -1473271 + 478073*1i; 1282602 + -1382973*1i; 981342 + -28345*1i; -958284 + 525826*1i; -612179 + -119307*1i; 672688 + -87580*1i; 278588 + 116576*1i; -350417 + -82449*1i; -98809 + -122446*1i; 104830 + 131843*1i; 80072 + 97519*1i; -23055 + -119175*1i; -35922 + -31527*1i; 1679 + 41794*1i; 12065 + 21541*1i; 4584 + -5662*1i; -2529 + -11598*1i; -242 + 8091*1i; -2675 + -2928*1i; 31713 + -3461*1i; -4370 + -5006*1i];
hw_fft_col4 = [-35217 + -805*1i; 6205 + 7141*1i; 26224 + -13263*1i; -8406 + 4760*1i; 5790 + 5028*1i; 3569 + -21848*1i; -2004 + 28728*1i; -2263 + 10432*1i; -3262 + -39457*1i; 5603 + -8738*1i; 8262 + 50683*1i; 122387 + -4758*1i; -110025 + -24454*1i; -160046 + 81585*1i; 70299 + -11388*1i; 273156 + -338710*1i; -51923 + -71675*1i; -122294 + 702571*1i; 205522 + 443091*1i; -289273 + -1031488*1i; -927089 + -877298*1i; 771905 + 959916*1i; 2396244 + 727384*1i; -540162 + -750326*1i; -3984473 + 566708*1i; 729845 + 929471*1i; 3274550 + -2046135*1i; -1108504 + -70409*1i; -1303101 + 1915883*1i; 593980 + -170834*1i; 254315 + -1386622*1i; -257620 + 143340*1i; 214541 + 857189*1i; 115091 + -99241*1i; -368520 + -384601*1i; 17702 + 40144*1i; 246237 + 103453*1i; -43035 + -11257*1i; -120091 + 33477*1i; 23352 + -9831*1i; 1939 + -69955*1i; 47798 + 39408*1i; -24460 + 16737*1i; -20886 + 11875*1i; -6276 + -35489*1i; -158 + 31413*1i; 21213 + -19523*1i; -18003 + 1395*1i; -12792 + 15344*1i; 3638 + -4765*1i; -31431 + -7163*1i; 56627 + 10332*1i; -40952 + -1698*1i; 4661 + 2405*1i; 15618 + 16082*1i; -6521 + -48798*1i; -4623 + 56408*1i; -736 + -29489*1i; 1903 + -7002*1i; -15497 + 9239*1i; 9089 + -2391*1i; 6019 + -232*1i; 570 + -473*1i; -23131 + -2433*1i; 17607 + 6045*1i; -4407 + -8473*1i; -7231 + -1424*1i; 4112 + -4653*1i; -11418 + 4743*1i; -5491 + 9746*1i; -11295 + 2466*1i; 41349 + -18202*1i; -45373 + 16532*1i; 33265 + 4860*1i; -9635 + 9602*1i; -22478 + -18484*1i; 6851 + 13470*1i; 14176 + -5386*1i; -10570 + 9220*1i; 28722 + 2088*1i; -48561 + -27519*1i; -18 + 19023*1i; 18946 + -27681*1i; 14422 + 25638*1i; -14331 + 4171*1i; -609 + 7291*1i; -25696 + -43536*1i; 8434 + -30877*1i; 58339 + 60458*1i; -17410 + 43341*1i; -126255 + -53304*1i; 9990 + 3444*1i; 207580 + -98321*1i; 18220 + -45549*1i; -319887 + 391756*1i; 76660 + 91553*1i; 202013 + -827045*1i; -230831 + -155427*1i; 194239 + 1394909*1i; 582397 + 130197*1i; -1244089 + -1879609*1i; -1157921 + 82523*1i; 3324979 + 1994599*1i; 688924 + -922369*1i; -3959629 + -522608*1i; -554746 + 732069*1i; 2395150 + -724424*1i; 783466 + -955236*1i; -949950 + 885285*1i; -270106 + 1040156*1i; 221448 + -458777*1i; -118555 + -716433*1i; -90716 + 110022*1i; 289144 + 329472*1i; 76227 + -7272*1i; -195641 + -55949*1i; -36535 + 6584*1i; 47231 + -15510*1i; 27164 + -21972*1i; 24459 + -4250*1i; -13626 + 35958*1i; 2471 + 973*1i; -10087 + -18355*1i; 11968 + 11321*1i; -136 + -6009*1i; -4142 + -1647*1i; 27305 + 14310*1i; 4365 + -9163*1i];
hw_fft_col5 = [-14264 + 6746*1i; 8554 + 3727*1i; 9129 + -14564*1i; 3865 + 6364*1i; 8611 + -2166*1i; -11272 + 3524*1i; 15517 + 6066*1i; 11031 + -33240*1i; -31021 + -4359*1i; 98638 + 20686*1i; 13578 + -57421*1i; -57934 + 229556*1i; 208448 + -2805*1i; -533978 + -172265*1i; -98928 + 457768*1i; 516414 + -1026651*1i; -1026556 + -492000*1i; 1621952 + 1169008*1i; 1507484 + -1773896*1i; -2418123 + 2017557*1i; 2542290 + 2915720*1i; -2355830 + -4267877*1i; -2491570 + 2260273*1i; 3186845 + -21028*1i; -364383 + -2065087*1i; -849061 + 1316696*1i; 1186757 + 422962*1i; -367737 + -750680*1i; -596682 + 534582*1i; 473144 + 74987*1i; -150005 + -476156*1i; -190519 + 182455*1i; 277456 + 98653*1i; -22004 + -199822*1i; -96970 + 173895*1i; 42698 + 41422*1i; -6890 + -116069*1i; -70033 + 45243*1i; 40185 + -7940*1i; 9855 + -22255*1i; -42590 + 1468*1i; 53776 + 18778*1i; -18820 + 18367*1i; -18738 + -25271*1i; -3480 + -2100*1i; -6892 + -1190*1i; -4806 + -6420*1i; -455 + 38271*1i; 30136 + -41170*1i; -31087 + 26507*1i; -9945 + 16658*1i; 14382 + -48071*1i; 13443 + 15364*1i; -41938 + -2089*1i; 9974 + 14593*1i; 16992 + 10378*1i; -8805 + -8815*1i; -12614 + -6935*1i; 5359 + -8222*1i; -510 + 2456*1i; -4598 + 15209*1i; -3134 + -11654*1i; 176 + 504*1i; -6482 + -9936*1i; -3252 + 11788*1i; -2134 + -7645*1i; 4149 + 9121*1i; 2172 + -10678*1i; -10254 + 2467*1i; 2080 + -27987*1i; -8338 + 29476*1i; -18021 + 296*1i; -1970 + 29097*1i; 15131 + -44800*1i; 3509 + 40678*1i; 10215 + -36891*1i; -26575 + -11792*1i; 24020 + 23621*1i; -28924 + -3351*1i; 19564 + 9510*1i; -20459 + 7978*1i; 2594 + -20842*1i; 7242 + 1378*1i; -1445 + 9047*1i; -9173 + -15857*1i; -10244 + 479*1i; -6604 + 15787*1i; 32483 + -47857*1i; -46215 + 26059*1i; 11346 + 18201*1i; 21835 + -27324*1i; -24516 + -8170*1i; -30781 + 71561*1i; 84929 + -40620*1i; -124310 + -115808*1i; -22529 + 138094*1i; 305766 + -67435*1i; -220779 + -169500*1i; -124461 + 441033*1i; 466812 + -56703*1i; -613532 + -534094*1i; -339112 + 760627*1i; 1158263 + -452205*1i; -842517 + -1317401*1i; -363587 + 2085562*1i; 3201423 + 23859*1i; -2503249 + -2283233*1i; -2371534 + 4294739*1i; 2557426 + -2910823*1i; -2403915 + -2016898*1i; 1489262 + 1722036*1i; 1622192 + -1141201*1i; -1006867 + 505280*1i; 526285 + 1016603*1i; -144471 + -447279*1i; -515170 + 168837*1i; 223321 + 13278*1i; -75047 + -253315*1i; 19696 + 75008*1i; 86699 + 7431*1i; -28313 + -31121*1i; 15531 + 45179*1i; 10834 + -2682*1i; -9184 + -782*1i; 9888 + -5040*1i; 306 + 2079*1i; 18744 + 17628*1i; -108 + -15736*1i];
hw_fft_col6 = [-48562 + 538*1i; 2120 + 3597*1i; -35917 + -18992*1i; -13652 + 11724*1i; -20922 + -7816*1i; -14666 + -15945*1i; -44401 + 10289*1i; 31792 + -4789*1i; -123236 + -58445*1i; 99598 + 150228*1i; -40324 + -303259*1i; -291362 + 390592*1i; 594680 + -212152*1i; -1053100 + -307816*1i; 815722 + 1096869*1i; -314795 + -2049209*1i; -1410335 + 2122002*1i; 3108878 + -1747461*1i; -4459829 + -1089782*1i; 3820748 + 3453062*1i; -232189 + -4679387*1i; -944890 + 3709604*1i; 2581002 + -1791455*1i; -2068044 + 1045926*1i; 1728281 + 470544*1i; -1142772 + -417249*1i; 446506 + 894993*1i; -178553 + -589067*1i; -233329 + 566219*1i; 186242 + -270034*1i; -340984 + 169725*1i; 216768 + 25002*1i; -222869 + -90010*1i; 102984 + 99938*1i; -95378 + -87892*1i; 6321 + 119907*1i; 29158 + -97027*1i; -84392 + 105622*1i; 50424 + -52468*1i; -68131 + 13946*1i; 36152 + 34848*1i; -40642 + -21880*1i; -10579 + 47757*1i; -19983 + -31464*1i; -5200 + 26540*1i; -444 + -14372*1i; -37285 + 7978*1i; 39570 + 34203*1i; -39688 + -28398*1i; -9486 + 13951*1i; -12960 + 30003*1i; -9990 + -9754*1i; -28319 + -2299*1i; 15212 + -12573*1i; -15348 + 42972*1i; -3979 + 5738*1i; -29731 + -11730*1i; 5188 + 21619*1i; -13552 + -19967*1i; 7912 + 35668*1i; -26462 + -17899*1i; -28690 + -4878*1i; 8296 + 10789*1i; -19814 + -6428*1i; -10638 + 8304*1i; -4504 + -3922*1i; -25053 + -10891*1i; -11979 + 16326*1i; 13626 + 2452*1i; -26157 + -21357*1i; -28362 + -21377*1i; 9896 + 50460*1i; 18704 + -23383*1i; -36844 + 1098*1i; 286 + -20361*1i; -25366 + -4380*1i; 565 + 12347*1i; -12347 + -13624*1i; -9470 + -2321*1i; -3624 + 2211*1i; -9015 + 11126*1i; -21980 + -29805*1i; -15527 + -3819*1i; 23976 + 8866*1i; -62340 + -25213*1i; 33940 + 34865*1i; -31366 + -57533*1i; -22453 + 41890*1i; 32654 + -42228*1i; -92531 + -8464*1i; 72785 + -1913*1i; -68643 + -40530*1i; 5360 + 50466*1i; 3404 + -97996*1i; -96108 + 88675*1i; 148260 + -87590*1i; -257175 + 34750*1i; 231180 + -4508*1i; -384230 + -147433*1i; 227214 + 284649*1i; -255746 + -571119*1i; -176249 + 566328*1i; 446826 + -895338*1i; -1132201 + 406497*1i; 1705910 + -432602*1i; -2066827 + -1091862*1i; 2618182 + 1827549*1i; -988625 + -3707536*1i; -195970 + 4678704*1i; 3803269 + -3493564*1i; -4476275 + 1096423*1i; 3149738 + 1786260*1i; -1448630 + -2135682*1i; -310592 + 2049640*1i; 835900 + -1106666*1i; -1060858 + 310088*1i; 606432 + 208521*1i; -324570 + -393846*1i; -1867 + 310669*1i; 70551 + -157198*1i; -123156 + 52245*1i; 35266 + 23052*1i; -47986 + -19007*1i; -6604 + 14454*1i; -25044 + 3373*1i; -10942 + -12492*1i; -38398 + 26527*1i; 5136 + -12603*1i];
hw_fft_col7 = [24004 + 706*1i; 47991 + 3789*1i; 15164 + 8259*1i; 45199 + 5861*1i; 39164 + 11223*1i; 23020 + 18853*1i; 58682 + 4055*1i; -2171 + 42412*1i; 91663 + 17279*1i; -51526 + 34903*1i; 167751 + 33294*1i; -159039 + 21341*1i; 298942 + 130769*1i; -342620 + -135414*1i; 505242 + 392030*1i; -535526 + -577478*1i; 673249 + 1101191*1i; -665734 + -1349289*1i; 636001 + 2019640*1i; -429462 + -2476062*1i; 87339 + 3411636*1i; 522368 + -3800592*1i; -1150321 + 4313399*1i; 1678365 + -3940387*1i; -1710757 + 3131209*1i; 1346463 + -2566693*1i; -1119432 + 1770386*1i; 901692 + -1478668*1i; -756872 + 979767*1i; 621829 + -852364*1i; -479904 + 525421*1i; 407140 + -476664*1i; -284877 + 235348*1i; 250863 + -233451*1i; -165856 + 73899*1i; 161257 + -151831*1i; -76155 + 60823*1i; 56836 + -94520*1i; 13457 + -15616*1i; 59322 + -59832*1i; -22332 + 8429*1i; 63396 + -53496*1i; 22524 + -18870*1i; 28666 + -41838*1i; 13430 + -6672*1i; 60861 + -43002*1i; -4869 + 18799*1i; 70136 + -66619*1i; -28468 + 25943*1i; 84032 + -58239*1i; -7569 + 21968*1i; 65061 + -30290*1i; -2431 + 151*1i; 27758 + -21223*1i; 57498 + -28732*1i; 36572 + 8974*1i; 5247 + -7715*1i; 13150 + -29172*1i; 35318 + 12575*1i; 34596 + -3074*1i; 29703 + -2923*1i; 14708 + -10423*1i; 54206 + -5992*1i; 22645 + 4005*1i; 28378 + 6550*1i; 29423 + -13693*1i; 26832 + 12190*1i; 35622 + -2292*1i; 8688 + 3693*1i; 56168 + 13644*1i; 30954 + 2433*1i; 34393 + -3738*1i; -762 + 44995*1i; 25662 + -16685*1i; 26985 + 37904*1i; 55569 + -6265*1i; -4408 + -12340*1i; 68472 + 80914*1i; 21512 + -40251*1i; 21005 + 33222*1i; 30153 + -10010*1i; 44827 + 35234*1i; 6379 + 20464*1i; 24417 + 31592*1i; 32657 + 23688*1i; 38314 + 37138*1i; 22243 + 6743*1i; 31565 + 79130*1i; 15271 + -34304*1i; 40334 + 113803*1i; -6742 + -20011*1i; 94208 + 78713*1i; -81778 + -20126*1i; 129146 + 142684*1i; -106985 + -85320*1i; 219629 + 277916*1i; -296803 + -295087*1i; 404887 + 504477*1i; -475704 + -523632*1i; 637936 + 829777*1i; -763781 + -954703*1i; 891620 + 1446107*1i; -1113813 + -1760606*1i; 1346520 + 2557082*1i; -1719271 + -3100463*1i; 1685683 + 3907569*1i; -1159142 + -4309198*1i; 504478 + 3836781*1i; 106204 + -3417187*1i; -432217 + 2448970*1i; 607751 + -2019633*1i; -630104 + 1351024*1i; 680832 + -1100380*1i; -547605 + 614674*1i; 466743 + -482584*1i; -291924 + 209874*1i; 277157 + -193653*1i; -159800 + 21107*1i; 182587 + -42580*1i; -66652 + -52408*1i; 100197 + 4246*1i; -10342 + -41701*1i; 62104 + -10538*1i; 25355 + -16327*1i; 35113 + -8006*1i; 45883 + -9287*1i; 14035 + -3228*1i; 48761 + -6357*1i];
hw_fft_col8 = [-59371 + -12180*1i; -7603 + -1289*1i; -54156 + 9661*1i; -15227 + -12004*1i; -37861 + -4967*1i; -17427 + -8475*1i; -41134 + -10950*1i; -17582 + -19020*1i; -34036 + -24188*1i; -34043 + -24276*1i; -39692 + 8249*1i; 7992 + -90935*1i; -43828 + 55620*1i; -77522 + -202586*1i; 122126 + 144026*1i; -376998 + -244498*1i; 495338 + 16828*1i; -815314 + 25439*1i; 770097 + -607315*1i; -922120 + 903740*1i; 399046 + -1741425*1i; -130693 + 2117249*1i; -1260505 + -2766762*1i; 2177714 + 2705492*1i; -4653500 + -2396441*1i; 4019954 + 1318162*1i; -3212196 + 560906*1i; 2177867 + -907956*1i; -1333377 + 1534311*1i; 602518 + -1266865*1i; -46583 + 1298153*1i; -223434 + -766764*1i; 425750 + 569799*1i; -403232 + -155417*1i; 392474 + 107741*1i; -228926 + 61366*1i; 161315 + -50122*1i; -56880 + 101028*1i; 12752 + -54045*1i; 16250 + 66715*1i; -10679 + 14640*1i; 8008 + 18348*1i; -20986 + 8788*1i; 314 + 11996*1i; -3457 + 37361*1i; -29889 + -2207*1i; 19719 + 22082*1i; -18289 + 14992*1i; -16091 + -1062*1i; -19503 + 50763*1i; -2648 + -27112*1i; 17064 + 177*1i; -38694 + -2071*1i; -7036 + 38936*1i; -30148 + -8914*1i; -23687 + 38415*1i; 19395 + -18594*1i; -2991 + -21963*1i; -8064 + 32599*1i; -39047 + -17395*1i; 18474 + 21168*1i; -38283 + -8373*1i; 1705 + 11579*1i; -15701 + -2469*1i; -22180 + -4882*1i; -1149 + 5458*1i; -17668 + 1036*1i; 1223 + -12153*1i; -5240 + 12018*1i; -36140 + -18728*1i; -9261 + -8565*1i; 18602 + 36160*1i; -43492 + -49560*1i; -2181 + 25149*1i; -17366 + -30349*1i; -11376 + -30888*1i; -7349 + 15028*1i; -14351 + 3302*1i; -9610 + -26239*1i; -43220 + -11649*1i; 38696 + 1499*1i; -44220 + -7945*1i; 2639 + -29319*1i; -2840 + 17009*1i; -10017 + -59947*1i; -9660 + 21906*1i; 7027 + -27128*1i; -23808 + -16772*1i; 15283 + -11235*1i; -21604 + -52296*1i; 40775 + 58025*1i; -66773 + -122908*1i; 133404 + 47598*1i; -171728 + -39561*1i; 343790 + -132499*1i; -380306 + 215724*1i; 400672 + -621866*1i; -228949 + 755546*1i; -39490 + -1245933*1i; 578471 + 1221347*1i; -1279654 + -1525060*1i; 2143816 + 915498*1i; -3224428 + -546467*1i; 4038890 + -1323567*1i; -4665451 + 2363257*1i; 2189260 + -2687840*1i; -1256958 + 2780930*1i; -154198 + -2126766*1i; 431888 + 1755385*1i; -953925 + -955823*1i; 757572 + 656351*1i; -808368 + -75749*1i; 478815 + 3073*1i; -333268 + 277296*1i; 108372 + -174978*1i; -93295 + 212083*1i; -4764 + -45020*1i; -33479 + 82124*1i; -61875 + -744*1i; 3024 + 21562*1i; -43322 + 31121*1i; -17112 + 4987*1i; -37229 + 21656*1i; -20596 + 2255*1i; -36587 + 4270*1i; -22290 + 13518*1i; -48513 + -15676*1i; -4630 + 18292*1i];
hw_fft_col9 = [-29304 + 316*1i; 28930 + -24605*1i; -830 + 30360*1i; -2829 + -10947*1i; 13668 + 16832*1i; 6442 + -24946*1i; 59736 + 20728*1i; -114525 + -36129*1i; 97791 + -126007*1i; -47685 + 339649*1i; -422702 + -299146*1i; 966280 + 228919*1i; -852217 + 861452*1i; 592843 + -1982568*1i; 1702233 + 1892475*1i; -3819667 + -1525614*1i; 3213452 + -1901614*1i; -2459982 + 4948726*1i; -1140776 + -3496249*1i; 4126228 + 2417858*1i; -2334840 + 498552*1i; 1363326 + -2419137*1i; 679382 + 985702*1i; -1161631 + -661379*1i; 387883 + -650569*1i; -262314 + 411764*1i; -510454 + -293452*1i; 83817 + 15355*1i; -223755 + 286999*1i; -176032 + -25537*1i; 90634 + 169359*1i; -20670 + 169537*1i; 59475 + 2928*1i; 136529 + 21349*1i; 16303 + -5239*1i; 23729 + -67592*1i; 8851 + -23706*1i; -49909 + -53046*1i; -4241 + -23827*1i; -31079 + 3252*1i; -27103 + 34335*1i; -8123 + 2836*1i; -2907 + 16149*1i; -23963 + 19258*1i; 20613 + -7059*1i; 4959 + -2792*1i; -31279 + 16341*1i; 39984 + -5702*1i; -25421 + 5469*1i; -9828 + -33255*1i; -32039 + 15565*1i; 17999 + -12495*1i; -20843 + 28638*1i; -2596 + -20096*1i; -3762 + 46688*1i; 21091 + -64075*1i; 5719 + 29853*1i; -20832 + -545*1i; -7817 + -11053*1i; -13244 + 16419*1i; 6844 + -24001*1i; 2303 + 11616*1i; -2392 + 7883*1i; -9710 + -11760*1i; -2262 + 2976*1i; -3079 + 2535*1i; -16204 + -3070*1i; -8275 + -14404*1i; 22923 + 31716*1i; -26416 + -2189*1i; 1022 + -5890*1i; 2839 + -1615*1i; 25530 + -2621*1i; -35576 + 745*1i; 10193 + 7177*1i; -19771 + -35080*1i; -7695 + 20297*1i; -2916 + -11193*1i; -15799 + -6560*1i; 12248 + 6698*1i; -23014 + 21967*1i; 16303 + -30048*1i; -8475 + 32483*1i; -12028 + -14609*1i; 24994 + -11599*1i; -1220 + 10124*1i; -18390 + -46954*1i; -8369 + 27942*1i; -37875 + -35684*1i; -14354 + -26522*1i; -29335 + 82431*1i; -72367 + 4779*1i; 69711 + 12068*1i; 12164 + 75331*1i; 13532 + 19849*1i; 130370 + -32209*1i; 50717 + -10776*1i; -10107 + -156759*1i; 97223 + -166154*1i; -175190 + 29049*1i; -222812 + -300180*1i; 87476 + -7459*1i; -519958 + 314227*1i; -253939 + -438342*1i; 381343 + 672831*1i; -1148721 + 642232*1i; 666365 + -992089*1i; 1339540 + 2404673*1i; -2317265 + -474135*1i; 4152545 + -2422146*1i; -1167270 + 3495011*1i; -2477941 + -4926955*1i; 3270267 + 1861012*1i; -3841146 + 1541537*1i; 1695978 + -1918770*1i; 541613 + 2007312*1i; -795231 + -885229*1i; 931876 + -199460*1i; -395110 + 322095*1i; -69968 + -369966*1i; 113548 + 142536*1i; -121750 + 28529*1i; 56278 + -28936*1i; 9263 + 27795*1i; 19836 + -7509*1i; -4849 + 2868*1i; -467 + -26255*1i; 27467 + 24320*1i];
hw_fft_col10 = [-38174 + -11828*1i; 7624 + 1298*1i; 21096 + 19556*1i; -5154 + -6044*1i; -6524 + -8018*1i; -5561 + 19855*1i; 19562 + -4807*1i; 35791 + -37264*1i; -31988 + -10360*1i; -136597 + -33592*1i; 1219 + 50530*1i; 129486 + 291349*1i; 22284 + 55115*1i; 352655 + -604393*1i; 325056 + -93884*1i; -1244255 + 44455*1i; -805944 + -566132*1i; 1287236 + 1282503*1i; -12468 + 2231473*1i; -206675 + -2337770*1i; 2908579 + -2418552*1i; -2043813 + 2658106*1i; -3372521 + -680585*1i; 2959054 + -469703*1i; 924135 + 1735761*1i; -1322981 + -615907*1i; 135424 + -1233682*1i; 394570 + 584782*1i; -511302 + 590979*1i; -9440 + -388945*1i; 435024 + -64050*1i; -77635 + 119978*1i; -261003 + -109084*1i; 108079 + -15886*1i; 19485 + 138586*1i; 9996 + -10340*1i; -3312 + -69694*1i; 1394 + -12031*1i; -34531 + 26203*1i; 11401 + -9979*1i; -16985 + 35970*1i; 12142 + -36319*1i; 19984 + 18156*1i; 9980 + -27360*1i; -40922 + 3690*1i; -348 + 17587*1i; 32770 + 9390*1i; -33656 + -13444*1i; 28632 + -17806*1i; -20525 + 11643*1i; 8725 + 19426*1i; 5210 + -4389*1i; -14314 + -31298*1i; 24814 + 44960*1i; -3574 + -38976*1i; -8267 + 15610*1i; -12101 + -9423*1i; -7619 + 7080*1i; 15533 + 32221*1i; 17485 + -46293*1i; -17478 + 20333*1i; -516 + -9620*1i; -4480 + -8367*1i; 8016 + 5125*1i; -10396 + 6827*1i; 11377 + -9120*1i; -7926 + 4920*1i; 719 + -17387*1i; 11656 + -1132*1i; -26210 + 28559*1i; 20380 + -12318*1i; 21185 + -5985*1i; -4094 + -17145*1i; -40711 + 49093*1i; 16328 + -55708*1i; 27926 + 20972*1i; -33617 + 6098*1i; 15416 + 19947*1i; -13721 + -22652*1i; -4368 + -15373*1i; 9650 + 17138*1i; -2337 + -4432*1i; -1286 + 11070*1i; 14675 + -19068*1i; -7014 + 12788*1i; -5162 + 384*1i; -6378 + 7883*1i; 31746 + -418*1i; -4163 + 14919*1i; 6141 + -16551*1i; -39999 + -80722*1i; 12630 + 50472*1i; -8495 + 115206*1i; 12237 + -45484*1i; 23240 + -127427*1i; 96044 + 65286*1i; -245644 + 79832*1i; -113174 + -152992*1i; 481003 + 88913*1i; -22244 + 347896*1i; -523157 + -552101*1i; 421927 + -608376*1i; 115762 + 1239407*1i; -1326158 + 580104*1i; 936517 + -1693525*1i; 2951840 + 462941*1i; -3387670 + 659617*1i; -2011808 + -2630462*1i; 2895166 + 2421549*1i; -213321 + 2314846*1i; 32244 + -2195344*1i; 1276445 + -1283411*1i; -869620 + 577378*1i; -1201472 + -88738*1i; 309517 + 153257*1i; 366724 + 585099*1i; -30964 + -71757*1i; 173690 + -292181*1i; -8949 + -39519*1i; -127729 + 30921*1i; -41217 + 15895*1i; 40003 + 24408*1i; 19682 + 7476*1i; -8729 + -10551*1i; -3978 + 6030*1i; -5005 + -1345*1i; 20454 + -14958*1i; 2569 + 12139*1i];

figure;
difff(matlab_fft_col1, hw_fft_col1 / 2^7, 'MATLAB FFT of Col 1', 'Hardware FFT of Col 1');

figure;
difff(matlab_fft_col2, hw_fft_col2 / 2^7, 'MATLAB FFT of Col 2', 'Hardware FFT of Col 2');

figure;
difff(matlab_fft_col3, hw_fft_col3 / 2^7, 'MATLAB FFT of Col 3', 'Hardware FFT of Col 3');

figure;
difff(matlab_fft_col4, hw_fft_col4 / 2^7, 'MATLAB FFT of Col 4', 'Hardware FFT of Col 4');

figure;
difff(matlab_fft_col5, hw_fft_col5 / 2^7, 'MATLAB FFT of Col 5', 'Hardware FFT of Col 5');

figure;
difff(matlab_fft_col6, hw_fft_col6 / 2^7, 'MATLAB FFT of Col 6', 'Hardware FFT of Col 6');

figure;
difff(matlab_fft_col7, hw_fft_col7 / 2^7, 'MATLAB FFT of Col 7', 'Hardware FFT of Col 7');

figure;
difff(matlab_fft_col8, hw_fft_col8 / 2^7, 'MATLAB FFT of Col 8', 'Hardware FFT of Col 8');

figure;
difff(matlab_fft_col9, hw_fft_col9 / 2^7, 'MATLAB FFT of Col 9', 'Hardware FFT of Col 9');

figure;
difff(matlab_fft_col10, hw_fft_col10 / 2^7, 'MATLAB FFT of Col 10', 'Hardware FFT of Col 10');
